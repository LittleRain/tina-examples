!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.tina={})}(this,function(t){"use strict";function e(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={},o=function(o){r[o]=function(){for(var r=arguments.length,a=Array(r),u=0;u<r;u++)a[u]=arguments[u];n&&e[o].apply(this,a),"function"==typeof t[o]&&t[o].apply(this,a),n||e[o].apply(this,a)}};for(var a in e)o(a);return b({},t,r)}function n(t){var e=t.TargetClass,n=t.getSourceInstance;return t.properties.forEach(function(t){Object.defineProperty(e.prototype,t,{set:function(e){n(this)[t]=e},get:function(){var e=n(this),r=e[t];return"function"==typeof r?r.bind(e):r}})}),e}function r(){this.setData(),this.$log("Initial Middleware","Ready")}function o(t){return O(t,{attached:r,onLoad:r})}function a(){this.$log=this.constructor.log.bind(this.constructor),this.$log("Log Middleware","Ready")}function u(t){return O(t,{beforeCreate:a,beforeLoad:a})}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n={};for(var r in t)n[r]=e(t[r],r,t);return n}function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n={};for(var r in t)e(t[r],r,t)&&(n[r]=t[r]);return n}function f(t){var e={};return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach(function(n){e[n]=t[n]}),e}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.filter(function(t){return-1===e.indexOf(t)})}function s(t){return Object.keys(t).map(function(e){return t[e]})}var p=[function(t){return function(){return t.apply(null,arguments)}},function(t){return function(e){return t.apply(null,arguments)}},function(t){return function(e,n){return t.apply(null,arguments)}},function(t){return function(e,n,r){return t.apply(null,arguments)}},function(t){return function(e,n,r,o){return t.apply(null,arguments)}},function(t){return function(e,n,r,o,a){return t.apply(null,arguments)}}],d=function(t,e){return e&&e<=5?p[e](t):t},h=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(function(t,e){return e={exports:{}},t(e,e.exports),e.exports}(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];var a=e.filter(function(t){return"function"==typeof t}),u=a.length-1,i=0;if(a.length<=0)throw new Error("No funcs passed");return u>=0&&a[u]&&(i=a[u].length),n.default(a.reduce(r),i)};var n=function(t){return t&&t.__esModule?t:{default:t}}(d),r=function(t,e){return function(){return t(e.apply(void 0,arguments))}};t.exports=e.default})),y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},g=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),b=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},m=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},_=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},w=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},O=function(t,n){return e(t,n)},P=function(t,n){return e(t,n,!0)},j={App:App,Page:Page,Component:Component,wx:wx},S=function(){function t(){v(this,t)}return g(t,[{key:"setData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=b({},this.data,t);if("function"==typeof this.compute&&(n=b({},n,this.compute(n))),n=function(t,e){var n={};for(var r in t)t[r]!==e[r]&&(n[r]=t[r]);return n}(n,this.data),this.constructor.log("setData",n),function(t){if(null==t)return!0;if(t.length>0)return!1;if(0===t.length)return!0;for(var e in t)if(hasOwnProperty.call(t,e))return!1;return!0}(n))return e();this.$source.setData(n,e)}},{key:"data",set:function(t){throw new Error("Not allowed to set ``data``, use ``setData(data, [callback])`` instead.")},get:function(){throw new Error("class Basic doesnot have a ``data`` atttribute, please implement the ``data`` getter in the child-class.")}}],[{key:"use",value:function(t){this.middlewares.unshift(t)}},{key:"log",value:function(t,e){this.debug&&console.log("[Tina."+this.name+"] - "+t+(e?": ":""),e)}}]),t}();S.debug=!1,S.middlewares=[];var A=["data","onLoad","onReady","onShow","onHide","onUnload","onPullDownRefresh","onReachBottom","onShareAppMessage","onPageScroll"],$=["onLoad","onReady","onShow","onHide","onUnload","onPullDownRefresh","onReachBottom","onShareAppMessage","onPageScroll"],k=$.reduce(function(t,e){return b({},t,function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},e,e.replace(/^on/,"before")))},{}),x=[u,o],D=function(t){function e(t){var n,r=t.model,o=void 0===r?{}:r;t.$source;v(this,e);var a=_(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),u=b({compute:o.compute||function(){return{}}},o.methods,c(o,function(t,e){return~[].concat($,w(s(k))).indexOf(e)}));for(var i in u)a[i]=u[i];return n=a,_(a,n)}return m(e,S),g(e,null,[{key:"define",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=[].concat(x,w(e.middlewares));t=h.apply(void 0,w(n.reverse()))(t);var r=b({},function(t){return i(t||{},function(t,e){return function(){for(var t=this.__tina_page__,n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return t[e].apply(t,r)}})}(t.methods),function(){var t={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:$).forEach(function(e){var n=e.replace(/^on/,"before");t[e]=function(){var t=this.__tina_page__;if(t[n]&&t[n].apply(t,arguments),t[e])return t[e].apply(t,arguments)}}),t}());r=P(r,{onLoad:function(){var n=new e({model:t,$source:this});this.__tina_page__=n,n.$source=this}}),new j.Page(b({},f(t,l(A,$)),r))}}]),g(e,[{key:"data",get:function(){return this.$source.data}}]),e}();D.middlewares=[],n({TargetClass:D,getSourceInstance:function(t){return t.$source},properties:[].concat(w(l(["data","route"],["data"])),w(l(["setData"],["setData"])))});var C=["properties","data","methods","behaviors","created","attached","ready","moved","detached","relations","options"],E=["created","attached","ready","moved","detached"],R={created:"beforeCreate",attached:"beforeAttach",ready:"beforeReady",move:"beforeMove",detached:"beforeDetach"},M=[o,u],L=function(t){function e(t){var n,r=t.model,o=void 0===r?{}:r;t.$source;v(this,e);var a=_(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),u=b({compute:o.compute||function(){return{}}},o.methods,c(o,function(t,e){return~[].concat(E,w(s(R))).indexOf(e)}));for(var i in u)a[i]=u[i];return n=a,_(a,n)}return m(e,S),g(e,null,[{key:"define",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=[].concat(M,w(e.middlewares));t=h.apply(void 0,w(n.reverse()))(t);var r=b({properties:function(t){function e(t){return function(){var e=this.__tina_component__;e.setData();for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return"string"==typeof t?e[t].apply(e,r):"function"==typeof t?t.apply(e,r):void 0}}return i(t||{},function(t){return"function"==typeof t||null===t?{type:t,observer:e()}:"object"===(void 0===t?"undefined":y(t))?b({},t,{observer:e(t.observer)}):void 0})}(t.properties),methods:function(t){return i(t||{},function(t,e){return function(){for(var t=this.__tina_component__,n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return t[e].apply(t,r)}})}(t.methods)},function(){var t={};return E.forEach(function(e){var n=R[e];n&&(t[e]=function(){var t=this.__tina_component__;if(t[n]&&t[n].apply(t,arguments),t[e])return t[e].apply(t,arguments)})}),t}());r=P(r,{created:function(){var n=new e({model:t,$source:this});this.__tina_component__=n,n.$source=this}}),new j.Component(b({},f(t,l(C,E)),r))}}]),g(e,[{key:"data",get:function(){return this.$source.data}}]),e}();L.middlewares=[],n({TargetClass:L,getSourceInstance:function(t){return t.$source},properties:[].concat(w(l(["is","id","dataset","data"],["data"])),w(l(["setData","hasBehavior","triggerEvent","createSelectorQuery","selectComponent","selectAllComponents","getRelationNodes"],["setData"])))}),t.Page=D,t.Component=L,t.appendHooks=O,t.prependHooks=P,Object.defineProperty(t,"__esModule",{value:!0})});