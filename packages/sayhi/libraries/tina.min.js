!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.tina=n()}(this,function(){"use strict";function t(t){var n={};return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach(function(e){e in t&&(n[e]=t[e])}),n}function n(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.filter(function(t){return-1===n.indexOf(t)})}function e(t){return Object.keys(t).map(function(n){return t[n]})}function r(){var t={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(n){var e=w(n,2),r=e[0],o=e[1];return t[r]=o}),t}function o(t){var n=t.TargetClass,e=t.getSourceInstance;return t.properties.forEach(function(t){Object.defineProperty(n.prototype,t,{set:function(n){e(this)[t]=n},get:function(){var n=e(this),r=n[t];return"function"==typeof r?r.bind(n):r}})}),n}function i(){this.setData(),this.$log("Initial Mixin","Ready")}function a(){this.$log=this.constructor.log.bind(this.constructor),this.$log("Log Mixin","Ready")}function u(t,n){if("object"===(void 0===n?"undefined":v(n))){var e=l(y(n,function(t,n){return"object"===(void 0===n?"undefined":v(n))&&void 0!==n.value}),function(t,n){return n.value});t=t.merge(e)}return t.toPlainObject()}function c(t){return l(t||{},function(t,n){return function(){for(var n=this.__tina_instance__,e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return n[t].apply(n,r)}})}function s(t,n){return r(t.map(function(t){var e=n(t);return[t,function(){var n=this.__tina_instance__;if(e&&n[e]&&n[e].apply(n,arguments),n[t])return n[t].apply(n,arguments)}]}))}var f=Object.prototype.toString,l=function(t,n){for(var e={},r=Object.keys(t),o=r.length,i=0;i<o;i++){var a=r[i];e[a]=n(a,t[a])}return e},h=function(t,n){function e(t,a){a>n||"function"!=typeof t&&void 0!==t&&("object"!=typeof t||!t||t instanceof i?o+=t:-1===r.indexOf(t)&&a!==n&&(r.push(t),o+="{",Object.keys(t).forEach(function(n,r,i){if("_"!==n.charAt(0)){var u=typeof t[n];"function"!==u&&"undefined"!==u&&(o+=n,e(t[n],a+1))}})))}n=n||10;var r=[],o="",i=RegExp;return e(t,0),o},p=Object.prototype.hasOwnProperty,d=function(t,n,e){!function(t,n,e){for(var r in t)if(!1===n.call(e,t[r],r,t))break}(t,function(r,o){if(p.call(t,o))return n.call(e,t[o],o,t)})},y=function(t,n){for(var e={},r=Object.keys(t),o=r.length,i=0;i<o;i++){var a=r[i];n(a,t[a])&&(e[a]=t[a])}return e},v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")},m=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),b=function(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t},_=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},O=function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)},j=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n},w=function(){return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,n){var e=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return e}(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),x=function(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)},P=function(){function t(n){var e=this;g(this,t),d(n,function(t,n){e[n]=t})}return m(t,null,[{key:"isInstance",value:function(t){return t instanceof this}}]),m(t,[{key:"merge",value:function(t){return this.constructor.isInstance(t)||(t=new this.constructor(t)),new this.constructor(_({},this,t))}},{key:"diff",value:function(t){return new this.constructor(y(this,function(n,e){return e!==t[n]}))}},{key:"toPlainObject",value:function(){return l(this,function(t,n){return n})}}]),t}(),k=function(t){function n(t){g(this,n);var e=j(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return Object.defineProperty(e,"__signatures",{enumerable:!1,writable:!0}),e.sign(),e}return O(n,P),m(n,null,[{key:"isInstance",value:function(t){return t instanceof this}}]),m(n,[{key:"sign",value:function(){this.__signatures=l(this,function(t,n){return h(n)})}},{key:"signature",value:function(t){return this.__signatures[t]}},{key:"isDirty",value:function(t){var n=this;return t?!(!this[t]&&!this.__signatures[t])&&this.__signatures[t]!==h(this[t]):Object.keys(this).some(function(t){return n.isDirty(t)})}},{key:"diff",value:function(t){var e=this;return new n(y(this,function(n,r){return r!==t[n]||e.signature(n)!==t.signature(n)}))}}]),n}(),A={App:App,Page:Page,Component:Component,wx:wx},D=function(t,n){return Array.isArray(t)?t.concat(n):"object"===(void 0===t?"undefined":v(t))?_({},t,n):n},S=function(){function t(){g(this,t)}return m(t,[{key:"setData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},e=this.data.merge(t);"function"==typeof this.compute&&(e=e.merge(this.compute(e)));var r=e.diff(this.data).toPlainObject();if(function(t){var n;return"[object Object]"===f.call(t)&&(null===(n=Object.getPrototypeOf(t))||n===Object.getPrototypeOf({}))}(r)||console.warn("[Tina] - The data which is passed to MINA should be a plain object, please check your Data-class."),this.constructor.log("setData",r),this.data=e,function(t){if(null==t)return!0;if(t.length>0)return!1;if(0===t.length)return!0;for(var n in t)if(hasOwnProperty.call(t,n))return!1;return!0}(r))return n();this.$source.setData(r,n)}}],[{key:"mixin",value:function(t){this._mixins.push(t)}},{key:"mix",value:function(t,n){var e=this;if(Array.isArray(n))return n.reduce(function(t,n){return e.mix(t,n)},t);if("function"==typeof n)return this.mix(t,n(t,this));return _({},t,l(n,function(n,e){return D(t[n],e)}))}},{key:"log",value:function(t,n){this.debug&&console.log("[Tina."+this.name+"] - "+t+(n?": ":""),n)}}]),t}();S.debug=!1,S.Data=k,S._mixins=[];var $=function(t,n){return function(t,n){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={},o=function(o){r[o]=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];e&&n[o].apply(this,i),"function"==typeof t[o]&&t[o].apply(this,i),e||n[o].apply(this,i)}};for(var i in n)o(i);return _({},t,r)}(t,n,!0)},I={attached:i,onLoad:i},R={created:a,beforeLoad:a},C=["data","onLoad","onReady","onShow","onHide","onUnload","onPullDownRefresh","onReachBottom","onShareAppMessage","onPageScroll"],E=["onLoad","onReady","onShow","onHide","onUnload","onPullDownRefresh","onReachBottom","onShareAppMessage","onPageScroll"],T={onLoad:"beforeLoad"},L=["data"].concat(E),M=[].concat(E,x(e(T))),B=_({mixins:[],data:{},compute:function(){}},r(M.map(function(t){return[t,[]]})),{methods:{}}),U=[R,I],H=function(e){function r(n){var e,o=n.options,i=void 0===o?{}:o;n.$source;g(this,r);var a=j(this,(r.__proto__||Object.getPrototypeOf(r)).call(this)),u=_({data:i.data,compute:i.compute||function(){return{}}},i.methods,l(t(i,M),function(t,n){return function(){for(var t=this,e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return n.reduce(function(n,e){return e.apply(t,r.concat(n))},void 0)}}));for(var c in u)a[c]=u[c];return e=a,j(a,e)}return O(r,S),m(r,null,[{key:"define",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=this.mix(B,[].concat(U,x(this._mixins),x(e.mixins||[]),[e]))).data=this.Data.isInstance(e.data)?data:new this.Data(e.data);var o=_({data:u(e.data)},c(e.methods),s(E.filter(function(t){return e[t].length>0}),function(t){return T[t]}));o=$(o,{onLoad:function(){var t=new r({options:e,$source:this});this.__tina_instance__=t,t.$source=this}}),new A.Page(_({},t(e,n(C,L)),o))}}]),r}();H._mixins=[],o({TargetClass:H,getSourceInstance:function(t){return t.$source},properties:[].concat(x(n(["data","route"],["data"])),x(n(["setData"],["setData"])))});var N=["properties","data","methods","behaviors","created","attached","ready","moved","detached","relations","options"],Q=["created","attached","ready","moved","detached"],q={},z=["properties","data","methods"].concat(Q),F=[].concat(Q,x(e(q))),G=_({mixins:[],behaviors:[],properties:{},data:{},compute:function(){}},r(F.map(function(t){return[t,[]]})),{methods:{},relations:{},options:{}}),J=[R,I],K=function(e){function r(n){var e,o=n.options,i=void 0===o?{}:o;n.$source;g(this,r);var a=j(this,(r.__proto__||Object.getPrototypeOf(r)).call(this)),u=_({data:i.data,compute:i.compute||function(){return{}}},i.methods,l(t(i,F),function(t,n){return function(){for(var t=this,e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return n.reduce(function(n,e){return e.apply(t,r.concat(n))},void 0)}}));for(var c in u)a[c]=u[c];return e=a,j(a,e)}return O(r,S),m(r,null,[{key:"define",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=this.mix(G,[].concat(J,x(this._mixins),x(e.mixins||[]),[e]))).data=this.Data.isInstance(e.data)?data:new this.Data(e.data);var o=_({data:u(e.data,e.properties),properties:function(t){function n(t,n){return function(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];var i=r[0],a=this.__tina_instance__,u=this.__tina_instance__.constructor.Data;return a.setData(new u(b({},t,i))),"string"==typeof n?a[n].apply(a,r):"function"==typeof n?n.apply(a,r):void 0}}return l(t||{},function(t,e){return"function"==typeof e||null===e?{type:e,observer:n(t)}:"object"===(void 0===e?"undefined":v(e))?_({},e,{observer:n(t,e.observer)}):void 0})}(e.properties),methods:c(e.methods)},s(Q.filter(function(t){return e[t].length>0}),function(t){return q[t]}));o=$(o,{created:function(){var t=new r({options:e,$source:this});this.__tina_instance__=t,t.$source=this}}),new A.Component(_({},t(e,n(N,z)),o))}}]),r}();K._mixins=[],o({TargetClass:K,getSourceInstance:function(t){return t.$source},properties:[].concat(x(n(["is","id","dataset","data"],["data"])),x(n(["setData","hasBehavior","triggerEvent","createSelectorQuery","selectComponent","selectAllComponents","getRelationNodes"],["setData"])))});var V=function(){function t(){g(this,t)}return m(t,null,[{key:"use",value:function(t){if(~this._plugins.indexOf(t))return this;if("function"==typeof t.install){for(var n=arguments.length,e=Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];t.install.apply(t,[this].concat(e))}return this._plugins.push(t),this}}]),t}();return V.Unit=S,V.Page=H,V.Component=K,V.BasicData=P,V.SigmundData=k,V._plugins=[],V});