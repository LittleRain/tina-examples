!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.tina={})}(this,function(t){"use strict";function n(t){var n={};return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach(function(e){e in t&&(n[e]=t[e])}),n}function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.filter(function(t){return-1===n.indexOf(t)})}function r(t){return Object.keys(t).map(function(n){return t[n]})}function o(){var t={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(n){var e=x(n,2),r=e[0],o=e[1];return t[r]=o}),t}function i(t){var n=t.TargetClass,e=t.getSourceInstance;return t.properties.forEach(function(t){Object.defineProperty(n.prototype,t,{set:function(n){e(this)[t]=n},get:function(){var n=e(this),r=n[t];return"function"==typeof r?r.bind(n):r}})}),n}function a(){this.setData(),this.$log("Initial Mixin","Ready")}function u(){this.$log=this.constructor.log.bind(this.constructor),this.$log("Log Mixin","Ready")}function c(t,n){if("object"===(void 0===n?"undefined":g(n))){var e=h(v(n,function(t,n){return"object"===(void 0===n?"undefined":g(n))&&void 0!==n.value}),function(t,n){return n.value});t=t.merge(e)}return t.toPlainObject()}function s(t){return h(t||{},function(t,n){return function(){for(var n=this.__tina_instance__,e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return n[t].apply(n,r)}})}function f(t,n){return o(t.map(function(t){var e=n(t);return[t,function(){var n=this.__tina_instance__;if(e&&n[e]&&n[e].apply(n,arguments),n[t])return n[t].apply(n,arguments)}]}))}var l=Object.prototype.toString,h=function(t,n){for(var e={},r=Object.keys(t),o=r.length,i=0;i<o;i++){var a=r[i];e[a]=n(a,t[a])}return e},p=function(t,n){function e(t,a){a>n||"function"!=typeof t&&void 0!==t&&("object"!=typeof t||!t||t instanceof i?o+=t:-1===r.indexOf(t)&&a!==n&&(r.push(t),o+="{",Object.keys(t).forEach(function(n,r,i){if("_"!==n.charAt(0)){var u=typeof t[n];"function"!==u&&"undefined"!==u&&(o+=n,e(t[n],a+1))}})))}n=n||10;var r=[],o="",i=RegExp;return e(t,0),o},d=Object.prototype.hasOwnProperty,y=function(t,n,e){!function(t,n,e){for(var r in t)if(!1===n.call(e,t[r],r,t))break}(t,function(r,o){if(d.call(t,o))return n.call(e,t[o],o,t)})},v=function(t,n){for(var e={},r=Object.keys(t),o=r.length,i=0;i<o;i++){var a=r[i];n(a,t[a])&&(e[a]=t[a])}return e},g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")},m=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),_=function(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t},O=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},j=function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)},w=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n},x=function(){return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,n){var e=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return e}(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),P=function(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)},k=function(){function t(n){var e=this;b(this,t),y(n,function(t,n){e[n]=t})}return m(t,null,[{key:"isInstance",value:function(t){return t instanceof this}}]),m(t,[{key:"merge",value:function(t){return this.constructor.isInstance(t)||(t=new this.constructor(t)),new this.constructor(O({},this,t))}},{key:"diff",value:function(t){return new this.constructor(v(this,function(n,e){return e!==t[n]}))}},{key:"toPlainObject",value:function(){return h(this,function(t,n){return n})}}]),t}(),A=function(t){function n(t){b(this,n);var e=w(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return Object.defineProperty(e,"__signatures",{enumerable:!1,writable:!0}),e.sign(),e}return j(n,k),m(n,null,[{key:"isInstance",value:function(t){return t instanceof this}}]),m(n,[{key:"sign",value:function(){this.__signatures=h(this,function(t,n){return p(n)})}},{key:"signature",value:function(t){return this.__signatures[t]}},{key:"isDirty",value:function(t){var n=this;return t?!(!this[t]&&!this.__signatures[t])&&this.__signatures[t]!==p(this[t]):Object.keys(this).some(function(t){return n.isDirty(t)})}},{key:"diff",value:function(t){var e=this;return new n(v(this,function(n,r){return r!==t[n]||e.signature(n)!==t.signature(n)}))}}]),n}(),D={App:App,Page:Page,Component:Component,wx:wx},S=function(t,n){return Array.isArray(t)?t.concat(n):"object"===(void 0===t?"undefined":g(t))?O({},t,n):n},$=function(){function t(){b(this,t)}return m(t,[{key:"setData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},e=this.data.merge(t);"function"==typeof this.compute&&(e=e.merge(this.compute(e)));var r=e.diff(this.data).toPlainObject();if(function(t){var n;return"[object Object]"===l.call(t)&&(null===(n=Object.getPrototypeOf(t))||n===Object.getPrototypeOf({}))}(r)||console.warn("[Tina] - The data which is passed to MINA should be a plain object, please check your Data-class."),this.constructor.log("setData",r),this.data=e,function(t){if(null==t)return!0;if(t.length>0)return!1;if(0===t.length)return!0;for(var n in t)if(hasOwnProperty.call(t,n))return!1;return!0}(r))return n();this.$source.setData(r,n)}}],[{key:"mixin",value:function(t){this.mixins.push(t)}},{key:"mix",value:function(t,n){var e=this;if(Array.isArray(n))return n.reduce(function(t,n){return e.mix(t,n)},t);if("function"==typeof n)return this.mix(t,n(t,this));return O({},t,h(n,function(n,e){return S(t[n],e)}))}},{key:"log",value:function(t,n){this.debug&&console.log("[Tina."+this.name+"] - "+t+(n?": ":""),n)}}]),t}();$.debug=!1,$.Data=A,$.mixins=[];var I=function(t,n){return function(t,n){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={},o=function(o){r[o]=function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];e&&n[o].apply(this,i),"function"==typeof t[o]&&t[o].apply(this,i),e||n[o].apply(this,i)}};for(var i in n)o(i);return O({},t,r)}(t,n,!0)},R={attached:a,onLoad:a},C={created:u,beforeLoad:u},E=["data","onLoad","onReady","onShow","onHide","onUnload","onPullDownRefresh","onReachBottom","onShareAppMessage","onPageScroll"],T=["onLoad","onReady","onShow","onHide","onUnload","onPullDownRefresh","onReachBottom","onShareAppMessage","onPageScroll"],L={onLoad:"beforeLoad"},M=["data"].concat(T),B=[].concat(T,P(r(L))),H=O({mixins:[],data:{},compute:function(){}},o(B.map(function(t){return[t,[]]})),{methods:{}}),N=[C,R],U=function(t){function r(t){var e,o=t.options,i=void 0===o?{}:o;t.$source;b(this,r);var a=w(this,(r.__proto__||Object.getPrototypeOf(r)).call(this)),u=O({data:i.data,compute:i.compute||function(){return{}}},i.methods,h(n(i,B),function(t,n){return function(){for(var t=this,e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return n.reduce(function(n,e){return e.apply(t,r.concat(n))},void 0)}}));for(var c in u)a[c]=u[c];return e=a,w(a,e)}return j(r,$),m(r,null,[{key:"define",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=this.mix(H,[].concat(N,P(this.mixins),P(t.mixins||[]),[t]))).data=this.Data.isInstance(t.data)?data:new this.Data(t.data);var o=O({data:c(t.data)},s(t.methods),f(T.filter(function(n){return t[n].length>0}),function(t){return L[t]}));o=I(o,{onLoad:function(){var n=new r({options:t,$source:this});this.__tina_instance__=n,n.$source=this}}),new D.Page(O({},n(t,e(E,M)),o))}}]),r}();U.mixins=[],i({TargetClass:U,getSourceInstance:function(t){return t.$source},properties:[].concat(P(e(["data","route"],["data"])),P(e(["setData"],["setData"])))});var Q=["properties","data","methods","behaviors","created","attached","ready","moved","detached","relations","options"],q=["created","attached","ready","moved","detached"],z={},F=["properties","data","methods"].concat(q),G=[].concat(q,P(r(z))),J=O({mixins:[],behaviors:[],properties:{},data:{},compute:function(){}},o(G.map(function(t){return[t,[]]})),{methods:{},relations:{},options:{}}),K=[C,R],V=function(t){function r(t){var e,o=t.options,i=void 0===o?{}:o;t.$source;b(this,r);var a=w(this,(r.__proto__||Object.getPrototypeOf(r)).call(this)),u=O({data:i.data,compute:i.compute||function(){return{}}},i.methods,h(n(i,G),function(t,n){return function(){for(var t=this,e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return n.reduce(function(n,e){return e.apply(t,r.concat(n))},void 0)}}));for(var c in u)a[c]=u[c];return e=a,w(a,e)}return j(r,$),m(r,null,[{key:"define",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=this.mix(J,[].concat(K,P(this.mixins),P(t.mixins||[]),[t]))).data=this.Data.isInstance(t.data)?data:new this.Data(t.data);var o=O({data:c(t.data,t.properties),properties:function(t){function n(t,n){return function(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];var i=r[0],a=this.__tina_instance__,u=this.__tina_instance__.constructor.Data;return a.setData(new u(_({},t,i))),"string"==typeof n?a[n].apply(a,r):"function"==typeof n?n.apply(a,r):void 0}}return h(t||{},function(t,e){return"function"==typeof e||null===e?{type:e,observer:n(t)}:"object"===(void 0===e?"undefined":g(e))?O({},e,{observer:n(t,e.observer)}):void 0})}(t.properties),methods:s(t.methods)},f(q.filter(function(n){return t[n].length>0}),function(t){return z[t]}));o=I(o,{created:function(){var n=new r({options:t,$source:this});this.__tina_instance__=n,n.$source=this}}),new D.Component(O({},n(t,e(Q,F)),o))}}]),r}();V.mixins=[],i({TargetClass:V,getSourceInstance:function(t){return t.$source},properties:[].concat(P(e(["is","id","dataset","data"],["data"])),P(e(["setData","hasBehavior","triggerEvent","createSelectorQuery","selectComponent","selectAllComponents","getRelationNodes"],["setData"])))}),t.Basic=$,t.Page=U,t.Component=V,t.BasicData=k,t.SigmundData=A,Object.defineProperty(t,"__esModule",{value:!0})});
